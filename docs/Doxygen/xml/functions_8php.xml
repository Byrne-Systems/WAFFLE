<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.13">
  <compounddef id="functions_8php" kind="file" language="PHP">
    <compoundname>functions.php</compoundname>
    <innernamespace refid="namespace_controllers">Controllers</innernamespace>
    <innernamespace refid="namespace_w_a_f_f_l_e_1_1_functions">WAFFLE::Functions</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="normal">&lt;?php</highlight></codeline>
<codeline lineno="11" refid="namespace_w_a_f_f_l_e_1_1_functions" refkind="compound"><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespace_w_a_f_f_l_e_1_1_functions" kindref="compound">WAFFLE\Functions</ref>;</highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal">use<sp/><ref refid="namespace_w_a_f_f_l_e_1_1_functions" kindref="compound">WAFFLE\Functions</ref>;</highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal">require_once<sp/></highlight><highlight class="stringliteral">&apos;psl-config.php&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight></codeline>
<codeline lineno="23" refid="namespace_w_a_f_f_l_e_1_1_functions_1a09d3696edbb60db132cbac829c0a96dd" refkind="member"><highlight class="keyword">function</highlight><highlight class="normal"><sp/><ref refid="namespace_w_a_f_f_l_e_1_1_functions_1a09d3696edbb60db132cbac829c0a96dd" kindref="member">sec_session_start</ref>()<sp/>{</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/>$session_name<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;sec_session_id&apos;</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Set:<sp/>custom<sp/>session<sp/>name</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/>$secure<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Denies:<sp/>JavaScript<sp/>from<sp/>being<sp/>able<sp/>to<sp/>access<sp/>the<sp/>session<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/>$httponly<sp/><sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Forces<sp/>sessions<sp/>to<sp/>only<sp/>use<sp/>cookies</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ini_set(</highlight><highlight class="stringliteral">&apos;session.use_only_cookies&apos;</highlight><highlight class="normal">,<sp/>1)<sp/>===<sp/>FALSE)<sp/>{</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header(</highlight><highlight class="stringliteral">&quot;Location:<sp/>../error.php?err=Could<sp/>not<sp/>initiate<sp/>a<sp/>safe<sp/>session<sp/>(ini_set)&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>exit();</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/>$cookieParams<sp/>=<sp/>session_get_cookie_params();<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Get:<sp/>current<sp/>cookies<sp/>params</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/>session_set_cookie_params($cookieParams[</highlight><highlight class="stringliteral">&quot;lifetime&quot;</highlight><highlight class="normal">],<sp/>$cookieParams[</highlight><highlight class="stringliteral">&quot;path&quot;</highlight><highlight class="normal">],<sp/>$cookieParams[</highlight><highlight class="stringliteral">&quot;domain&quot;</highlight><highlight class="normal">],<sp/>$secure,<sp/>$httponly);</highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/>session_name($session_name);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Set:<sp/>session<sp/>name<sp/>to<sp/>the<sp/>one<sp/></highlight><highlight class="keyword">set</highlight><highlight class="normal"><sp/>above</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/>session_start();<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Start:<sp/>PHP<sp/>session</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/>session_regenerate_id(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Regenerate:<sp/>session;<sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>the<sp/>old<sp/>one</highlight></codeline>
<codeline lineno="39"><highlight class="normal">}</highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="50" refid="namespace_w_a_f_f_l_e_1_1_functions_1a7573c72280bfa987322364343fd97eec" refkind="member"><highlight class="keyword">function</highlight><highlight class="normal"><sp/><ref refid="namespace_w_a_f_f_l_e_1_1_functions_1a7573c72280bfa987322364343fd97eec" kindref="member">login</ref>($id,<sp/>$pass,<sp/><ref refid="init_8php_1a580989e8e3521433691a0351287f6315" kindref="member">$mysqli</ref>)<sp/>{</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#<sp/>Using<sp/>prepared<sp/>statements<sp/>means<sp/>that<sp/>SQL<sp/>injection<sp/>is<sp/>not<sp/>possible.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>($stmt<sp/>=<sp/><ref refid="init_8php_1a580989e8e3521433691a0351287f6315" kindref="member">$mysqli</ref>-&gt;prepare(</highlight><highlight class="stringliteral">&quot;SELECT<sp/>id,<sp/>password<sp/>FROM<sp/>credentials<sp/>WHERE<sp/>empID<sp/>=<sp/>?<sp/>LIMIT<sp/>1&quot;</highlight><highlight class="normal">))<sp/>{</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$stmt-&gt;bind_param(</highlight><highlight class="charliteral">&apos;s&apos;</highlight><highlight class="normal">,<sp/>$id);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Bind:<sp/></highlight><highlight class="stringliteral">&apos;$email&apos;</highlight><highlight class="normal"><sp/>to<sp/>parameter</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$stmt-&gt;execute();<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Execute:<sp/>the<sp/>prepared<sp/>query</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$stmt-&gt;store_result();</highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$stmt-&gt;bind_result($emp_id,<sp/>$password);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Get:<sp/>variables<sp/>from<sp/>result.</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$stmt-&gt;fetch();</highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Verify:<sp/>whether<sp/>user<sp/>exists<sp/>and<sp/>check<sp/>whether<sp/>the<sp/>account<sp/>is<sp/>locked<sp/>from<sp/>too<sp/>many<sp/>login<sp/>attempts</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>($stmt-&gt;num_rows<sp/>==<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="namespace_w_a_f_f_l_e_1_1_functions_1a0a6eed95810480a504f0334d3c23ccbc" kindref="member">checkbrute</ref>($emp_id,<sp/><ref refid="init_8php_1a580989e8e3521433691a0351287f6315" kindref="member">$mysqli</ref>)<sp/>==<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Account<sp/>is<sp/>locked;<sp/>Send<sp/>an<sp/>email<sp/>to<sp/>user<sp/>saying<sp/>their<sp/>account<sp/>is<sp/>locked</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Check<sp/>if<sp/>the<sp/>password<sp/>in<sp/>the<sp/>database<sp/>matches<sp/>the<sp/>password<sp/>the<sp/>user<sp/>submitted.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(password_verify($password,<sp/>$db_password))<sp/>{</highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Password<sp/>correct!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$user_browser<sp/>=<sp/>$_SERVER[</highlight><highlight class="stringliteral">&apos;HTTP_USER_AGENT&apos;</highlight><highlight class="normal">];<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Get:<sp/>the<sp/>user-agent<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>of<sp/>the<sp/>user.</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$_SESSION[</highlight><highlight class="stringliteral">&apos;emp_id&apos;</highlight><highlight class="normal">]<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>$emp_id;</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$_SESSION[</highlight><highlight class="stringliteral">&apos;login_string&apos;</highlight><highlight class="normal">]<sp/>=<sp/>hash(</highlight><highlight class="stringliteral">&apos;sha512&apos;</highlight><highlight class="normal">,<sp/>$password<sp/>.<sp/>$user_browser);</highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Login<sp/>successful</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Password<sp/>not<sp/>correct!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$now<sp/>=<sp/>time();<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Record:<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal"><sp/>attempt<sp/>in<sp/>the<sp/>database</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="init_8php_1a580989e8e3521433691a0351287f6315" kindref="member">$mysqli</ref>-&gt;query(</highlight><highlight class="stringliteral">&quot;INSERT<sp/>INTO<sp/>login_attempts(id,<sp/>time)<sp/>VALUES<sp/>(&apos;$emp_id&apos;,<sp/>&apos;$now&apos;)&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Login<sp/>unsuccessful</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>No<sp/>user<sp/>exists.</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="90"><highlight class="normal">}</highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight></codeline>
<codeline lineno="99" refid="namespace_w_a_f_f_l_e_1_1_functions_1a0a6eed95810480a504f0334d3c23ccbc" refkind="member"><highlight class="keyword">function</highlight><highlight class="normal"><sp/><ref refid="namespace_w_a_f_f_l_e_1_1_functions_1a0a6eed95810480a504f0334d3c23ccbc" kindref="member">checkbrute</ref>($emp_id,<sp/><ref refid="init_8php_1a580989e8e3521433691a0351287f6315" kindref="member">$mysqli</ref>)<sp/>{</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/>$now<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>time();<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Get:<sp/>time-stamp<sp/>of<sp/>current<sp/>time</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/>$valid_attempts<sp/>=<sp/>$now<sp/>-<sp/>(2<sp/>*<sp/>60<sp/>*<sp/>60);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Count:<sp/>all<sp/><ref refid="namespace_w_a_f_f_l_e_1_1_functions_1a7573c72280bfa987322364343fd97eec" kindref="member">login</ref><sp/>attempts<sp/>within<sp/>the<sp/>past<sp/>2<sp/>hours</highlight></codeline>
<codeline lineno="102"><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>($stmt<sp/>=<sp/><ref refid="init_8php_1a580989e8e3521433691a0351287f6315" kindref="member">$mysqli</ref>-&gt;prepare(</highlight><highlight class="stringliteral">&quot;SELECT<sp/>time<sp/>FROM<sp/>login_attempts<sp/>WHERE<sp/>id<sp/>=<sp/>?<sp/>AND<sp/>time<sp/>&gt;<sp/>&apos;$valid_attempts&apos;&quot;</highlight><highlight class="normal">))<sp/>{</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$stmt-&gt;bind_param(</highlight><highlight class="charliteral">&apos;i&apos;</highlight><highlight class="normal">,<sp/>$emp_id);</highlight></codeline>
<codeline lineno="105"><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$stmt-&gt;execute();<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Execute<sp/>the<sp/>prepared<sp/>query</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$stmt-&gt;store_result();</highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>#<sp/>Check:<sp/>whether<sp/>there<sp/>has<sp/>been<sp/>more<sp/>than<sp/>5<sp/>failed<sp/>logins</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>($stmt-&gt;num_rows<sp/>&gt;<sp/>5)<sp/>{</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="116"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="C:/xampp/htdocs/apps/WAFFLE/inc/functions.php"/>
  </compounddef>
</doxygen>
